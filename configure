#!/usr/bin/env python
import os
import optparse

root_dir = os.path.dirname(os.path.realpath(__file__))

def write(filename, data):
    filename = os.path.join(root_dir, filename)
    print('creating ' + filename)
    f = open(filename, 'w+')
    f.write(data)
    f.close()

def main():
    parser = optparse.OptionParser()

    parser.add_option('--destdir',
        action='store',
        dest='destdir',
        help='Select the installation destination directory (defaults to /usr/local)')

    config = {};
    (options, args) = parser.parse_args()
    
    if options.destdir:
        config['DESTDIR'] = options.destdir
    
    config = '\n'.join(map('='.join, config.iteritems())) + '\n'
    write('config.mk', '# Do not edit. Generated by the configure script.\n' + config)

if __name__ == '__main__':
    main()
